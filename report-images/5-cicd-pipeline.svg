<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 750">
  <defs>
    <style>
      .title { font: bold 20px sans-serif; fill: #2c3e50; }
      .stage { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .test { fill: #27ae60; stroke: #229954; stroke-width: 2; }
      .deploy { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .security { fill: #f39c12; stroke: #d68910; stroke-width: 2; }
      .text { font: 13px sans-serif; fill: white; text-anchor: middle; }
      .smalltext { font: 11px sans-serif; fill: white; text-anchor: middle; }
      .label { font: 12px sans-serif; fill: #2c3e50; }
      .arrow { stroke: #7f8c8d; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .success { fill: #27ae60; }
      .fail { fill: #e74c3c; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#7f8c8d" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="450" y="30" class="title">CI/CD Pipeline Architecture</text>
  
  <!-- Trigger -->
  <rect x="375" y="60" width="150" height="50" class="stage" rx="5"/>
  <text x="450" y="82" class="text" style="font-weight: bold;">GitHub Push</text>
  <text x="450" y="98" class="smalltext">Trigger: main branch</text>
  
  <path d="M 450 110 L 450 140" class="arrow"/>
  
  <!-- Stage 1: Install & Setup -->
  <rect x="50" y="140" width="800" height="80" fill="#ecf0f1" stroke="#34495e" stroke-width="2" rx="5"/>
  <text x="450" y="165" class="label" style="font-size: 16px; font-weight: bold;">Stage 1: Install & Setup</text>
  
  <rect x="70" y="180" width="180" height="30" class="stage" rx="3"/>
  <text x="160" y="200" class="text">Checkout Code</text>
  
  <rect x="270" y="180" width="180" height="30" class="stage" rx="3"/>
  <text x="360" y="200" class="text">Setup Node.js 18.x, 20.x</text>
  
  <rect x="470" y="180" width="180" height="30" class="stage" rx="3"/>
  <text x="560" y="200" class="text">Install Dependencies</text>
  
  <rect x="670" y="180" width="160" height="30" class="stage" rx="3"/>
  <text x="750" y="200" class="text">Cache node_modules</text>
  
  <path d="M 450 220 L 450 250" class="arrow"/>
  
  <!-- Stage 2: Code Quality -->
  <rect x="50" y="250" width="380" height="100" fill="#ecf0f1" stroke="#34495e" stroke-width="2" rx="5"/>
  <text x="240" y="275" class="label" style="font-size: 16px; font-weight: bold;">Stage 2: Code Quality</text>
  
  <rect x="70" y="290" width="160" height="30" class="stage" rx="3"/>
  <text x="150" y="310" class="text">ESLint Check</text>
  
  <rect x="250" y="290" width="160" height="30" class="stage" rx="3"/>
  <text x="330" y="310" class="text">Code Formatting</text>
  
  <!-- Stage 3: Security Scanning -->
  <rect x="470" y="250" width="380" height="100" fill="#ecf0f1" stroke="#34495e" stroke-width="2" rx="5"/>
  <text x="660" y="275" class="label" style="font-size: 16px; font-weight: bold;">Stage 3: Security Scanning</text>
  
  <rect x="490" y="290" width="160" height="30" class="security" rx="3"/>
  <text x="570" y="310" class="text">npm audit</text>
  
  <rect x="670" y="290" width="160" height="30" class="security" rx="3"/>
  <text x="750" y="310" class="text">Snyk Security</text>
  
  <rect x="490" y="330" width="160" height="30" class="security" rx="3"/>
  <text x="570" y="350" class="text">CodeQL Analysis</text>
  
  <path d="M 450 350 L 450 380" class="arrow"/>
  
  <!-- Stage 4: Testing -->
  <rect x="50" y="380" width="800" height="120" fill="#ecf0f1" stroke="#34495e" stroke-width="2" rx="5"/>
  <text x="450" y="405" class="label" style="font-size: 16px; font-weight: bold;">Stage 4: Testing</text>
  
  <rect x="80" y="420" width="160" height="30" class="test" rx="3"/>
  <text x="160" y="440" class="text">Unit Tests</text>
  
  <rect x="260" y="420" width="160" height="30" class="test" rx="3"/>
  <text x="340" y="440" class="text">Integration Tests</text>
  
  <rect x="440" y="420" width="160" height="30" class="test" rx="3"/>
  <text x="520" y="440" class="text">Controller Tests</text>
  
  <rect x="620" y="420" width="160" height="30" class="test" rx="3"/>
  <text x="700" y="440" class="text">Middleware Tests</text>
  
  <rect x="250" y="460" width="300" height="30" class="test" rx="3"/>
  <text x="400" y="480" class="text">Coverage Report (Mocha/Chai/Sinon)</text>
  
  <path d="M 450 500 L 450 530" class="arrow"/>
  
  <!-- Stage 5: Build -->
  <rect x="50" y="530" width="380" height="80" fill="#ecf0f1" stroke="#34495e" stroke-width="2" rx="5"/>
  <text x="240" y="555" class="label" style="font-size: 16px; font-weight: bold;">Stage 5: Build Verification</text>
  
  <rect x="80" y="570" width="160" height="30" class="stage" rx="3"/>
  <text x="160" y="590" class="text">Build Application</text>
  
  <rect x="250" y="570" width="160" height="30" class="stage" rx="3"/>
  <text x="330" y="590" class="text">Verify Dependencies</text>
  
  <!-- Stage 6: Deployment -->
  <rect x="470" y="530" width="380" height="80" fill="#ecf0f1" stroke="#34495e" stroke-width="2" rx="5"/>
  <text x="660" y="555" class="label" style="font-size: 16px; font-weight: bold;">Stage 6: Deployment</text>
  
  <rect x="490" y="570" width="170" height="30" class="deploy" rx="3"/>
  <text x="575" y="590" class="text">Deploy to Cloudflare</text>
  
  <rect x="670" y="570" width="160" height="30" class="deploy" rx="3"/>
  <text x="750" y="590" class="text">Update Wrangler</text>
  
  <path d="M 450 610 L 450 640" class="arrow"/>
  
  <!-- Success/Failure -->
  <g>
    <rect x="300" y="640" width="130" height="50" class="success" rx="5"/>
    <text x="365" y="665" class="text" style="font-weight: bold;">✓ Success</text>
    <text x="365" y="680" class="smalltext">Deploy Complete</text>
  </g>
  
  <g>
    <rect x="470" y="640" width="130" height="50" class="fail" rx="5"/>
    <text x="535" y="665" class="text" style="font-weight: bold;">✗ Failure</text>
    <text x="535" y="680" class="smalltext">Rollback & Notify</text>
  </g>
  
  <!-- GitHub Actions Info -->
  <rect x="50" y="710" width="800" height="30" fill="#2c3e50" rx="5"/>
  <text x="450" y="732" class="text" style="font-size: 14px;">GitHub Actions Workflow • Automated on Push to main • Matrix Testing: Node 18.x & 20.x</text>
</svg>
