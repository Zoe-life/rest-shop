<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 650">
  <defs>
    <style>
      .title { font: bold 20px sans-serif; fill: #2c3e50; }
      .subtitle { font: bold 14px sans-serif; fill: #34495e; }
      .layer { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .feature { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .text { font: 13px sans-serif; fill: white; text-anchor: middle; }
      .smalltext { font: 11px sans-serif; fill: white; }
      .label { font: 12px sans-serif; fill: #2c3e50; }
      .arrow { stroke: #7f8c8d; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#7f8c8d" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="400" y="30" class="title">Security Architecture</text>
  
  <!-- Multi-Layer Defense -->
  <text x="400" y="60" class="subtitle">Defense in Depth Strategy</text>
  
  <!-- Layer 1: Network Security -->
  <rect x="50" y="80" width="700" height="80" class="layer" rx="5"/>
  <text x="400" y="108" class="text" style="font-size: 16px; font-weight: bold;">Layer 1: Network Security</text>
  <g>
    <rect x="70" y="120" width="150" height="30" class="feature" rx="3"/>
    <text x="145" y="140" class="text">HTTPS/TLS</text>
    
    <rect x="240" y="120" width="150" height="30" class="feature" rx="3"/>
    <text x="315" y="140" class="text">CORS Policy</text>
    
    <rect x="410" y="120" width="150" height="30" class="feature" rx="3"/>
    <text x="485" y="140" class="text">Helmet Headers</text>
    
    <rect x="580" y="120" width="150" height="30" class="feature" rx="3"/>
    <text x="655" y="140" class="text">Rate Limiting</text>
  </g>
  
  <path d="M 400 160 L 400 180" class="arrow"/>
  
  <!-- Layer 2: Authentication & Authorization -->
  <rect x="50" y="180" width="700" height="80" class="layer" rx="5"/>
  <text x="400" y="208" class="text" style="font-size: 16px; font-weight: bold;">Layer 2: Authentication & Authorization</text>
  <g>
    <rect x="90" y="220" width="130" height="30" class="feature" rx="3"/>
    <text x="155" y="240" class="text">JWT Tokens</text>
    
    <rect x="240" y="220" width="130" height="30" class="feature" rx="3"/>
    <text x="305" y="240" class="text">OAuth 2.0</text>
    
    <rect x="390" y="220" width="130" height="30" class="feature" rx="3"/>
    <text x="455" y="240" class="text">RBAC</text>
    
    <rect x="540" y="220" width="130" height="30" class="feature" rx="3"/>
    <text x="605" y="240" class="text">Passport.js</text>
  </g>
  
  <path d="M 400 260 L 400 280" class="arrow"/>
  
  <!-- Layer 3: Input Validation -->
  <rect x="50" y="280" width="700" height="80" class="layer" rx="5"/>
  <text x="400" y="308" class="text" style="font-size: 16px; font-weight: bold;">Layer 3: Input Validation & Sanitization</text>
  <g>
    <rect x="70" y="320" width="150" height="30" class="feature" rx="3"/>
    <text x="145" y="340" class="text">express-validator</text>
    
    <rect x="240" y="320" width="150" height="30" class="feature" rx="3"/>
    <text x="315" y="340" class="text">XSS Prevention</text>
    
    <rect x="410" y="320" width="150" height="30" class="feature" rx="3"/>
    <text x="485" y="340" class="text">ObjectId Check</text>
    
    <rect x="580" y="320" width="150" height="30" class="feature" rx="3"/>
    <text x="655" y="340" class="text">Schema Validation</text>
  </g>
  
  <path d="M 400 360 L 400 380" class="arrow"/>
  
  <!-- Layer 4: Data Security -->
  <rect x="50" y="380" width="700" height="80" class="layer" rx="5"/>
  <text x="400" y="408" class="text" style="font-size: 16px; font-weight: bold;">Layer 4: Data Security</text>
  <g>
    <rect x="90" y="420" width="140" height="30" class="feature" rx="3"/>
    <text x="160" y="440" class="text">Bcrypt Hashing</text>
    
    <rect x="250" y="420" width="140" height="30" class="feature" rx="3"/>
    <text x="320" y="440" class="text">MongoDB Auth</text>
    
    <rect x="410" y="420" width="140" height="30" class="feature" rx="3"/>
    <text x="480" y="440" class="text">Secure Secrets</text>
    
    <rect x="570" y="420" width="140" height="30" class="feature" rx="3"/>
    <text x="640" y="440" class="text">Audit Logging</text>
  </g>
  
  <!-- Security Features Details -->
  <rect x="50" y="480" width="700" height="150" fill="#ecf0f1" stroke="#34495e" stroke-width="2" rx="5"/>
  <text x="400" y="505" class="subtitle">Security Feature Details</text>
  
  <!-- Column 1 -->
  <g>
    <text x="70" y="530" class="label" style="font-weight: bold;">Rate Limiting:</text>
    <text x="70" y="548" class="label" style="font-size: 11px;">• API: 100 req/15 min</text>
    <text x="70" y="563" class="label" style="font-size: 11px;">• Auth: 5 attempts/15 min</text>
    <text x="70" y="578" class="label" style="font-size: 11px;">• Signup: 5 accounts/hour</text>
    <text x="70" y="593" class="label" style="font-size: 11px;">• IP-based tracking</text>
    <text x="70" y="608" class="label" style="font-size: 11px;">• Sliding window algorithm</text>
  </g>
  
  <!-- Column 2 -->
  <g>
    <text x="280" y="530" class="label" style="font-weight: bold;">Password Security:</text>
    <text x="280" y="548" class="label" style="font-size: 11px;">• Min 8 characters</text>
    <text x="280" y="563" class="label" style="font-size: 11px;">• Upper & lowercase required</text>
    <text x="280" y="578" class="label" style="font-size: 11px;">• Number required</text>
    <text x="280" y="593" class="label" style="font-size: 11px;">• Special char required</text>
    <text x="280" y="608" class="label" style="font-size: 11px;">• Bcrypt salt rounds: 12</text>
  </g>
  
  <!-- Column 3 -->
  <g>
    <text x="490" y="530" class="label" style="font-weight: bold;">Headers (Helmet):</text>
    <text x="490" y="548" class="label" style="font-size: 11px;">• X-Frame-Options: DENY</text>
    <text x="490" y="563" class="label" style="font-size: 11px;">• X-Content-Type: nosniff</text>
    <text x="490" y="578" class="label" style="font-size: 11px;">• CSP enabled</text>
    <text x="490" y="593" class="label" style="font-size: 11px;">• HSTS enabled</text>
    <text x="490" y="608" class="label" style="font-size: 11px;">• XSS Protection: 1</text>
  </g>
</svg>
